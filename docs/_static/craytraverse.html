
            
  <section id="renderer">
<h1>Renderer<a class="headerlink" href="#renderer" title="Permalink to this headline">¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="craytraverse.renderer.Renderer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">craytraverse.renderer.</span></span><span class="sig-name descname"><span class="pre">Renderer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rayargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scene</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nproc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/craytraverse/renderer/renderer.html#Renderer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#craytraverse.renderer.Renderer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Virtual class for wrapping c++ Radiance renderer executable classes</p>
<p>Do not use directly, either subclass or use existing: Rtrace, Rcontrib</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="craytraverse.renderer.Renderer.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'radiance_virtual'</span></em><a class="headerlink" href="#craytraverse.renderer.Renderer.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="craytraverse.renderer.Renderer.instance">
<span class="sig-name descname"><span class="pre">instance</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#craytraverse.renderer.Renderer.instance" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="craytraverse.renderer.Renderer.srcn">
<span class="sig-name descname"><span class="pre">srcn</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></em><a class="headerlink" href="#craytraverse.renderer.Renderer.srcn" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="craytraverse.renderer.Renderer.features">
<span class="sig-name descname"><span class="pre">features</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></em><a class="headerlink" href="#craytraverse.renderer.Renderer.features" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="craytraverse.renderer.Renderer.args">
<span class="sig-name descname"><span class="pre">args</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#craytraverse.renderer.Renderer.args" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="craytraverse.renderer.Renderer.nproc">
<span class="sig-name descname"><span class="pre">nproc</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></em><a class="headerlink" href="#craytraverse.renderer.Renderer.nproc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="craytraverse.renderer.Renderer.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/craytraverse/renderer/renderer.html#Renderer.run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#craytraverse.renderer.Renderer.run" title="Permalink to this definition">¶</a></dt>
<dd><p>alias for call, for consistency with SamplerPt classes for nested
dimensions of evaluation</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="craytraverse.renderer.Renderer.reset">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/craytraverse/renderer/renderer.html#Renderer.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#craytraverse.renderer.Renderer.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>reset engine instance and unset associated attributees</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="craytraverse.renderer.Renderer.set_args">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">set_args</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nproc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/craytraverse/renderer/renderer.html#Renderer.set_args"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#craytraverse.renderer.Renderer.set_args" title="Permalink to this definition">¶</a></dt>
<dd><p>prepare arguments to call engine instance initialization</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>args</strong> (<em>str</em>) – rendering options</p></li>
<li><p><strong>nproc</strong> (<em>int</em><em>, </em><em>optional</em>) – cpu limit</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="craytraverse.renderer.Renderer.load_scene">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">load_scene</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scene</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/craytraverse/renderer/renderer.html#Renderer.load_scene"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#craytraverse.renderer.Renderer.load_scene" title="Permalink to this definition">¶</a></dt>
<dd><p>load octree file to engine instance</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>scene</strong> (<em>str</em>) – path to octree file</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError:</strong> – can only be called after set_args, otherwise engine instance
    will abort.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="rtrace">
<h1>Rtrace<a class="headerlink" href="#rtrace" title="Permalink to this headline">¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="craytraverse.renderer.Rtrace">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">craytraverse.renderer.</span></span><span class="sig-name descname"><span class="pre">Rtrace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rayargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scene</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nproc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/craytraverse/renderer/rtrace.html#Rtrace"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#craytraverse.renderer.Rtrace" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#craytraverse.renderer.Renderer" title="craytraverse.renderer.renderer.Renderer"><code class="xref py py-class docutils literal notranslate"><span class="pre">craytraverse.renderer.renderer.Renderer</span></code></a></p>
<p>singleton wrapper for c++ raytrraverse.crenderer.cRtrace class</p>
<p>this class sets default arguments, helps with initialization and setting
cpu limits of the cRtrace instance. see raytraverse.crenderer.cRtrace
for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rayargs</strong> (<em>str</em><em>, </em><em>optional</em>) – argument string (options and flags only) raises ValueError if arguments
are not recognized by cRtrace.</p></li>
<li><p><strong>scene</strong> (<em>str</em><em>, </em><em>optional</em>) – path to octree</p></li>
<li><p><strong>nproc</strong> (<em>int</em><em>, </em><em>optional</em>) – if None, sets nproc to cpu count, or the RAYTRAVERSE_PROC_CAP
environment variable</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Basic Initialization and call:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">r</span> <span class="o">=</span> <span class="n">renderer</span><span class="o">.</span><span class="n">Rtrace</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">scene</span><span class="p">)</span>
<span class="n">ans</span> <span class="o">=</span> <span class="n">r</span><span class="p">(</span><span class="n">vecs</span><span class="p">)</span>
<span class="c1"># ans.shape -&gt; (vecs.shape[0], 1)</span>
</pre></div>
</div>
<p>If rayargs include cache files (ambient cache or photon map) be careful
with updating sources. If you are going to swap sources, update the
arguments as well with the new paths:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">r</span> <span class="o">=</span> <span class="n">renderer</span><span class="o">.</span><span class="n">Rtrace</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">scene</span><span class="p">)</span>
<span class="n">r</span><span class="o">.</span><span class="n">set_args</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;temp.amb&quot;</span><span class="p">,</span> <span class="s2">&quot;temp2.amb&quot;</span><span class="p">))</span>
<span class="n">r</span><span class="o">.</span><span class="n">load_source</span><span class="p">(</span><span class="n">srcdef</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that if you are using ambient caching, you must give an ambient file,
because without a file ambient values are not shared across processes or
successive calls to the instance.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="craytraverse.renderer.Rtrace.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'rtrace'</span></em><a class="headerlink" href="#craytraverse.renderer.Rtrace.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="craytraverse.renderer.Rtrace.instance">
<span class="sig-name descname"><span class="pre">instance</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;craytraverse.crenderer.rtrace_c.cRtrace</span> <span class="pre">object&gt;</span></em><a class="headerlink" href="#craytraverse.renderer.Rtrace.instance" title="Permalink to this definition">¶</a></dt>
<dd><p>craytraverse.crenderer.cRtrace</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="craytraverse.renderer.Rtrace.ospec">
<span class="sig-name descname"><span class="pre">ospec</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'v'</span></em><a class="headerlink" href="#craytraverse.renderer.Rtrace.ospec" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="craytraverse.renderer.Rtrace.set_args">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">set_args</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nproc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/craytraverse/renderer/rtrace.html#Rtrace.set_args"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#craytraverse.renderer.Rtrace.set_args" title="Permalink to this definition">¶</a></dt>
<dd><p>prepare arguments to call engine instance initialization</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>args</strong> (<em>str</em>) – rendering options</p></li>
<li><p><strong>nproc</strong> (<em>int</em><em>, </em><em>optional</em>) – cpu limit</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="craytraverse.renderer.Rtrace.update_ospec">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">update_ospec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/craytraverse/renderer/rtrace.html#Rtrace.update_ospec"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#craytraverse.renderer.Rtrace.update_ospec" title="Permalink to this definition">¶</a></dt>
<dd><p>set output of cRtrace instance</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>vs</strong> (<em>str</em>) – <dl class="simple">
<dt>output specifiers for rtrace::</dt><dd><p>o    origin (input)
d    direction (normalized)
v    value (radiance)
V    contribution (radiance)
w    weight
W    color coefficient
l    effective length of ray
L    first intersection distance
c    local (u,v) coordinates
p    point of intersection
n    normal at intersection (perturbed)
N    normal at intersection (unperturbed)
r    mirrored value contribution
x    unmirrored value contribution
R    mirrored ray length
X    unmirrored ray length</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>outcnt</strong> – the number of output columns to expect when calling rtrace instance</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>int</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError:</strong> – when an output specifier is not recognized</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="craytraverse.renderer.Rtrace.check_amb">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">check_amb</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/craytraverse/renderer/rtrace.html#Rtrace.check_amb"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#craytraverse.renderer.Rtrace.check_amb" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="craytraverse.renderer.Rtrace.load_source">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">load_source</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">srcfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freesrc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ambfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/craytraverse/renderer/rtrace.html#Rtrace.load_source"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#craytraverse.renderer.Rtrace.load_source" title="Permalink to this definition">¶</a></dt>
<dd><p>add a source description to the loaded scene</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>srcfile</strong> (<em>str</em>) – path to radiance scene file containing sources, these should not
change the bounding box of the octree and has only been tested with
the “source” type.</p></li>
<li><p><strong>freesrc</strong> (<em>int</em><em>, </em><em>optional</em>) – the number of objects to unload from the end of the rtrace object
list, if -1 unloads all objects loaded by previous calls to
load_source</p></li>
<li><p><strong>ambfile</strong> (<em>str</em><em>, </em><em>optional</em>) – path to ambient file. if given, and arguments</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="rcontrib">
<h1>Rcontrib<a class="headerlink" href="#rcontrib" title="Permalink to this headline">¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="craytraverse.renderer.Rcontrib">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">craytraverse.renderer.</span></span><span class="sig-name descname"><span class="pre">Rcontrib</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rayargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scene</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nproc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skyres</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">modname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'skyglow'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ground</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/craytraverse/renderer/rcontrib.html#Rcontrib"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#craytraverse.renderer.Rcontrib" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#craytraverse.renderer.Renderer" title="craytraverse.renderer.renderer.Renderer"><code class="xref py py-class docutils literal notranslate"><span class="pre">craytraverse.renderer.renderer.Renderer</span></code></a></p>
<p>singleton wrapper for c++ raytrraverse.crenderer.cRcontrib class</p>
<p>this class sets default arguments, helps with initialization and setting
cpu limits of the cRcontrib instance. see raytrraverse.crenderer.cRcontrib
for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rayargs</strong> (<em>str</em><em>, </em><em>optional</em>) – argument string (options and flags only) raises ValueError if arguments
are not recognized by cRtrace.</p></li>
<li><p><strong>scene</strong> (<em>str</em><em>, </em><em>optional</em>) – path to octree</p></li>
<li><p><strong>nproc</strong> (<em>int</em><em>, </em><em>optional</em>) – </p></li>
<li><p><strong>skyres</strong> (<em>int</em><em>, </em><em>optional</em>) – resolution of sky patches (sqrt(patches / hemisphere)).
So if skyres=18, each patch
will be 100 sq. degrees (0.03046174197 steradians) and there will be
18 * 18 = 324 sky patches.</p></li>
<li><p><strong>modname</strong> (<em>str</em><em>, </em><em>optional</em>) – passed the -m option of cRcontrib initialization</p></li>
<li><p><strong>ground</strong> (<em>bool</em><em>, </em><em>optional</em>) – if True include a ground source (included as a final bin)</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Basic Initialization and call:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">r</span> <span class="o">=</span> <span class="n">renderer</span><span class="o">.</span><span class="n">Rcontrib</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">scene</span><span class="p">)</span>
<span class="n">ans</span> <span class="o">=</span> <span class="n">r</span><span class="p">(</span><span class="n">vecs</span><span class="p">)</span>
<span class="c1"># ans.shape -&gt; (vecs.shape[0], 325)</span>
</pre></div>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="craytraverse.renderer.Rcontrib.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'rcontrib'</span></em><a class="headerlink" href="#craytraverse.renderer.Rcontrib.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="craytraverse.renderer.Rcontrib.instance">
<span class="sig-name descname"><span class="pre">instance</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;craytraverse.crenderer.rcontrib_c.cRcontrib</span> <span class="pre">object&gt;</span></em><a class="headerlink" href="#craytraverse.renderer.Rcontrib.instance" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="craytraverse.renderer.Rcontrib.ground">
<span class="sig-name descname"><span class="pre">ground</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#craytraverse.renderer.Rcontrib.ground" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="craytraverse.renderer.Rcontrib.skyres">
<span class="sig-name descname"><span class="pre">skyres</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">15</span></em><a class="headerlink" href="#craytraverse.renderer.Rcontrib.skyres" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="craytraverse.renderer.Rcontrib.srcn">
<span class="sig-name descname"><span class="pre">srcn</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">226</span></em><a class="headerlink" href="#craytraverse.renderer.Rcontrib.srcn" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="craytraverse.renderer.Rcontrib.modname">
<span class="sig-name descname"><span class="pre">modname</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'skyglow'</span></em><a class="headerlink" href="#craytraverse.renderer.Rcontrib.modname" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="craytraverse.renderer.Rcontrib.setup">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">setup</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scene</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ground</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">modname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'skyglow'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skyres</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/craytraverse/renderer/rcontrib.html#Rcontrib.setup"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#craytraverse.renderer.Rcontrib.setup" title="Permalink to this definition">¶</a></dt>
<dd><p>set class attributes for proper argument initialization</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scene</strong> (<em>str</em><em>, </em><em>optional</em>) – path to octree</p></li>
<li><p><strong>ground</strong> (<em>bool</em><em>, </em><em>optional</em>) – if True include a ground source (included as a final bin)</p></li>
<li><p><strong>modname</strong> (<em>str</em><em>, </em><em>optional</em>) – passed the -m option of cRcontrib initialization</p></li>
<li><p><strong>skyres</strong> (<em>float</em><em>, </em><em>optional</em>) – resolution of sky patches (sqrt(patches / hemisphere)).
So if skyres=10, each patch will be 100 sq. degrees
(0.03046174197 steradians) and there will be 18 * 18 = 324 sky
patches.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>scene</strong> – path to scene with added sky definition</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="craytraverse.renderer.Rcontrib.set_args">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">set_args</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nproc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/craytraverse/renderer/rcontrib.html#Rcontrib.set_args"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#craytraverse.renderer.Rcontrib.set_args" title="Permalink to this definition">¶</a></dt>
<dd><p>prepare arguments to call engine instance initialization</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>args</strong> (<em>str</em>) – rendering options</p></li>
<li><p><strong>nproc</strong> (<em>int</em><em>, </em><em>optional</em>) – cpu limit</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="crtrace">
<h1>cRtrace<a class="headerlink" href="#crtrace" title="Permalink to this headline">¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="craytraverse.crenderer.cRtrace">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">craytraverse.crenderer.</span></span><span class="sig-name descname"><span class="pre">cRtrace</span></span><a class="headerlink" href="#craytraverse.crenderer.cRtrace" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">pybind11_builtins.pybind11_object</span></code></p>
<p>singleton interface to the Radiance rtrace executable.</p>
<p>See the rtrace man page for a full description of the programs functionality. Instance is initialized with a list
of arguments similar to the command line tool, but with several differences:</p>
<blockquote>
<div><ul class="simple">
<li><p>no -f format specifier, input and output is always a numpy array.</p></li>
<li><p>no -h option.</p></li>
<li><p>no -x/-y options, shape output data as necessary with np.reshape</p></li>
<li><p>no -P/-PP modes</p></li>
<li><p>an additional -c N option repeats each input N times and averages the result. Make sure that uncorrelated sampling
is used (-U+, default)</p></li>
<li><p>the default output is -oz, z is an additional output specifier that yields a single photopic brightness per input
ray.</p></li>
<li><p>no s/m/M/t/T/~ allowed as output specifiers</p></li>
</ul>
</div></blockquote>
<p class="rubric">Examples</p>
<p>basic usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">raytraverse.crenderer</span> <span class="kn">import</span> <span class="n">cRtrace</span>
<span class="n">instance</span> <span class="o">=</span> <span class="n">cRtrace</span><span class="o">.</span><span class="n">get_instance</span><span class="p">()</span>
<span class="n">instance</span><span class="o">.</span><span class="n">initialize</span><span class="p">([</span><span class="s2">&quot;rtrace&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">])</span> <span class="c1">#Note: do not include octree at end!</span>
<span class="n">instance</span><span class="o">.</span><span class="n">load_scene</span><span class="p">(</span><span class="s2">&quot;scene.oct&quot;</span><span class="p">)</span>
<span class="c1"># ...</span>
<span class="c1"># define &#39;rays&#39; as a numpy array of shape (N, 6)</span>
<span class="c1"># ...</span>
<span class="n">lum</span> <span class="o">=</span> <span class="n">instance</span><span class="p">(</span><span class="n">rays</span><span class="p">)</span>
</pre></div>
</div>
<p>cRtrace can also update the output specification and/or the settings without reloading the scene geometry:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">instance</span><span class="o">.</span><span class="n">update_ospec</span><span class="p">(</span><span class="s2">&quot;L&quot;</span><span class="p">)</span> <span class="c1"># to query ray distance</span>
<span class="n">instance</span><span class="o">.</span><span class="n">initialize</span><span class="p">(</span><span class="s2">&quot;rtrace -ab 0 -lr 1&quot;</span><span class="o">.</span><span class="n">split</span><span class="p">())</span> <span class="c1"># note this begins with default arguments, it is not additive with previous settings!</span>
<span class="n">raylength</span> <span class="o">=</span> <span class="n">instance</span><span class="p">(</span><span class="n">rays</span><span class="p">)</span>
</pre></div>
</div>
<p>but if you are loading new geometry, the instance should be reset:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">instance</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="n">instance</span><span class="o">.</span><span class="n">initialize</span><span class="p">([</span><span class="s2">&quot;rtrace&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">])</span>
<span class="n">instance</span><span class="o">.</span><span class="n">load_scene</span><span class="p">(</span><span class="s2">&quot;scene2.oct&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>by loading a scene without light sources, sources can be dynamically loaded and unloaded without a reset:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">instance</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="n">instance</span><span class="o">.</span><span class="n">initialize</span><span class="p">([</span><span class="s2">&quot;rtrace&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">])</span>
<span class="n">instance</span><span class="o">.</span><span class="n">load_scene</span><span class="p">(</span><span class="s2">&quot;scene_no_sources.oct&quot;</span><span class="p">)</span>
<span class="n">instance</span><span class="o">.</span><span class="n">load_source</span><span class="p">(</span><span class="s2">&quot;sky.rad&quot;</span><span class="p">)</span>
<span class="n">skylum</span> <span class="o">=</span> <span class="n">instance</span><span class="p">(</span><span class="n">rays</span><span class="p">)</span>
<span class="n">instance</span><span class="o">.</span><span class="n">load_source</span><span class="p">(</span><span class="s2">&quot;sun.rad&quot;</span><span class="p">)</span> <span class="c1"># this unloads sky.rad and loads sun.rad</span>
<span class="n">sunlum</span> <span class="o">=</span> <span class="n">instance</span><span class="p">(</span><span class="n">rays</span><span class="p">)</span>
<span class="n">instance</span><span class="o">.</span><span class="n">load_source</span><span class="p">(</span><span class="s2">&quot;sky.rad&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="c1"># using the optional freesrc, keep the sun loaded</span>
<span class="n">totallum</span> <span class="o">=</span> <span class="n">instance</span><span class="p">(</span><span class="n">rays</span><span class="p">)</span>
<span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">skylum</span> <span class="o">+</span> <span class="n">sunlum</span><span class="p">,</span> <span class="n">totallum</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="mf">.03</span><span class="p">):</span> <span class="c1"># depending on rendering settings / scene complexity</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;light is additive!)</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<p>the cRtrace instance is best managed from a separate class that handles argument generation.
See raytraverse.renderer.Rtrace</p>
<dl class="py method">
<dt class="sig sig-object py" id="craytraverse.crenderer.cRtrace.__call__">
<span class="sig-name descname"><span class="pre">__call__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#craytraverse.crenderer.cRtrace" title="craytraverse.crenderer.rtrace_c.cRtrace"><span class="pre">craytraverse.crenderer.rtrace_c.cRtrace</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">vecs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.float64</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.float64</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#craytraverse.crenderer.cRtrace.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>run renderer for a set of rays</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>vecs</strong> (<em>np.array</em>) – shape (N, 6) origin + direction vectors</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>values</strong> – shape (N, M) result array, M depends on output specification</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="craytraverse.crenderer.cRtrace.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#craytraverse.crenderer.cRtrace.__init__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="craytraverse.crenderer.cRtrace.get_instance">
<span class="sig-name descname"><span class="pre">get_instance</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#craytraverse.crenderer.cRtrace" title="craytraverse.crenderer.rtrace_c.cRtrace"><span class="pre">craytraverse.crenderer.rtrace_c.cRtrace</span></a></span></span><a class="headerlink" href="#craytraverse.crenderer.cRtrace.get_instance" title="Permalink to this definition">¶</a></dt>
<dd><p>returns (instantiating if necessary) pointer to Renderer instance.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="craytraverse.crenderer.cRtrace.get_sources">
<span class="sig-name descname"><span class="pre">get_sources</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#craytraverse.crenderer.cRtrace" title="craytraverse.crenderer.rtrace_c.cRtrace"><span class="pre">craytraverse.crenderer.rtrace_c.cRtrace</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span></span></span><a class="headerlink" href="#craytraverse.crenderer.cRtrace.get_sources" title="Permalink to this definition">¶</a></dt>
<dd><p>return list of sources in model</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>sources</strong> (<em>np.array</em>) – shape: (N, 5) for each source x,y,z position (or direction), maximum radius, solid angle (or area)</p></li>
<li><p><strong>distant</strong> (<em>np.array</em>) – shape: (N,) True if source is distant (so x,y,z should be interpreted as direction)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="craytraverse.crenderer.cRtrace.initialize">
<span class="sig-name descname"><span class="pre">initialize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#craytraverse.crenderer.cRtrace" title="craytraverse.crenderer.rtrace_c.cRtrace"><span class="pre">craytraverse.crenderer.rtrace_c.cRtrace</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">arglist</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">object</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="headerlink" href="#craytraverse.crenderer.cRtrace.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>arglist (a sequence of strings) must be a member of calling
instance and persist for duration of program</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>arglist</strong> (<em>list</em>) – a sequence of arguments to initialize renderer. must be a member of calling
instance and persist for duration of program</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>nproc</strong> – number of processors renderer initialized with or -1 if initialization failed.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="craytraverse.crenderer.cRtrace.load_scene">
<span class="sig-name descname"><span class="pre">load_scene</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#craytraverse.crenderer.cRtrace" title="craytraverse.crenderer.rtrace_c.cRtrace"><span class="pre">craytraverse.crenderer.rtrace_c.cRtrace</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">octree</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#craytraverse.crenderer.cRtrace.load_scene" title="Permalink to this definition">¶</a></dt>
<dd><p>load scene file to renderer</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>octee</strong> (<em>str</em>) – path to octree file.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="craytraverse.crenderer.cRtrace.load_source">
<span class="sig-name descname"><span class="pre">load_source</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#craytraverse.crenderer.cRtrace" title="craytraverse.crenderer.rtrace_c.cRtrace"><span class="pre">craytraverse.crenderer.rtrace_c.cRtrace</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">srcname</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freesrc</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#craytraverse.crenderer.cRtrace.load_source" title="Permalink to this definition">¶</a></dt>
<dd><p>arglist (a sequence of strings) must be a member of calling
instance and persist for duration of program</p>
<p>updates private srcobj parameter for default removing all sources</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>srcname</strong> (<em>str</em>) – path to file with source definition.</p></li>
<li><p><strong>freesrc</strong> (<em>int</em><em>, </em><em>optional</em>) – number of previous sources to unload (unloads from end of object list
only safe if removing sources loaded by this function. If negative removes
all sources loaded by this function.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="craytraverse.crenderer.cRtrace.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#craytraverse.crenderer.cRtrace" title="craytraverse.crenderer.rtrace_c.cRtrace"><span class="pre">craytraverse.crenderer.rtrace_c.cRtrace</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#craytraverse.crenderer.cRtrace.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>reset renderer state, must be called before loading an new scene or changing rendering
parameters</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="craytraverse.crenderer.cRtrace.update_ospec">
<span class="sig-name descname"><span class="pre">update_ospec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#craytraverse.crenderer.cRtrace" title="craytraverse.crenderer.rtrace_c.cRtrace"><span class="pre">craytraverse.crenderer.rtrace_c.cRtrace</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">vs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="headerlink" href="#craytraverse.crenderer.cRtrace.update_ospec" title="Permalink to this definition">¶</a></dt>
<dd><p>update output values request</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>vs</strong> (<em>str</em>) – output specification string (see rtrace manpage option -o)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>ncomp</strong> – number of components renderer will return, or -1 on failure.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="crcontrib">
<h1>cRcontrib<a class="headerlink" href="#crcontrib" title="Permalink to this headline">¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="craytraverse.crenderer.cRcontrib">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">craytraverse.crenderer.</span></span><span class="sig-name descname"><span class="pre">cRcontrib</span></span><a class="headerlink" href="#craytraverse.crenderer.cRcontrib" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">pybind11_builtins.pybind11_object</span></code></p>
<p>singleton interface to the Radiance rcontrib executable.</p>
<p>See the rcontrib man page for a full description of the programs functionality. Instance is initialized with a list
of arguments similar to the command line tool, but with several differences:</p>
<blockquote>
<div><ul class="simple">
<li><p>no -o option. All output is written to a memory buffer returned as a Numpy array</p></li>
<li><p>no -f format specifier, input and output is always a numpy array.</p></li>
<li><p>no -r option.</p></li>
<li><p>no -h option.</p></li>
<li><p>the -c option repeats and accumulates input rays rather than accumulating input.</p></li>
<li><p>an additional flag -Z outputs a single brightness value (photopic) rather than 3-color channels. this is True
by default.</p></li>
</ul>
</div></blockquote>
<p class="rubric">Examples</p>
<p>basic usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">raytraverse.crenderer</span> <span class="kn">import</span> <span class="n">cRcontrib</span>
<span class="n">instance</span> <span class="o">=</span> <span class="n">cRcontrib</span><span class="o">.</span><span class="n">get_instance</span><span class="p">()</span>
<span class="n">instance</span><span class="o">.</span><span class="n">initialize</span><span class="p">([</span><span class="s2">&quot;rcontrib&quot;</span><span class="p">,</span> <span class="s2">&quot;-n&quot;</span><span class="p">,</span> <span class="s2">&quot;8&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="s2">&quot;-m&quot;</span><span class="p">,</span> <span class="s2">&quot;mod&quot;</span><span class="p">])</span>  <span class="c1">#Note: do not include octree at end!</span>
<span class="n">instance</span><span class="o">.</span><span class="n">load_scene</span><span class="p">(</span><span class="s2">&quot;scene.oct&quot;</span><span class="p">)</span>
<span class="c1"># ...</span>
<span class="c1"># define &#39;rays&#39; as a numpy array of shape (N, 6)</span>
<span class="c1"># ...</span>
<span class="n">contributions</span> <span class="o">=</span> <span class="n">instance</span><span class="p">(</span><span class="n">rays</span><span class="p">)</span>
</pre></div>
</div>
<p>Subsequent calls can be made to the instance, but if either the settings or scene are changed:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">instance</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="n">instance</span><span class="o">.</span><span class="n">initialize</span><span class="p">([</span><span class="s2">&quot;rcontrib&quot;</span><span class="p">,</span> <span class="s2">&quot;-n&quot;</span><span class="p">,</span> <span class="s2">&quot;8&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="s2">&quot;-m&quot;</span><span class="p">,</span> <span class="s2">&quot;mod2&quot;</span><span class="p">])</span>
<span class="n">instance</span><span class="o">.</span><span class="n">load_scene</span><span class="p">(</span><span class="s2">&quot;scene2.oct&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<p>the cRcontrib instance is best managed from a seperate class that handles argument generation.
See raytraverse.renderer.Rcontrib</p>
<dl class="py method">
<dt class="sig sig-object py" id="craytraverse.crenderer.cRcontrib.__call__">
<span class="sig-name descname"><span class="pre">__call__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#craytraverse.crenderer.cRcontrib" title="craytraverse.crenderer.rcontrib_c.cRcontrib"><span class="pre">craytraverse.crenderer.rcontrib_c.cRcontrib</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">vecs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.float64</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.float64</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#craytraverse.crenderer.cRcontrib.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>run renderer for a set of rays</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>vecs</strong> (<em>np.array</em>) – shape (N, 6) origin + direction vectors</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>values</strong> – shape (N, M) result array, M depends on output specification</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="craytraverse.crenderer.cRcontrib.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#craytraverse.crenderer.cRcontrib.__init__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="craytraverse.crenderer.cRcontrib.get_instance">
<span class="sig-name descname"><span class="pre">get_instance</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#craytraverse.crenderer.cRcontrib" title="craytraverse.crenderer.rcontrib_c.cRcontrib"><span class="pre">craytraverse.crenderer.rcontrib_c.cRcontrib</span></a></span></span><a class="headerlink" href="#craytraverse.crenderer.cRcontrib.get_instance" title="Permalink to this definition">¶</a></dt>
<dd><p>returns (instantiating if necessary) pointer to Renderer instance.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="craytraverse.crenderer.cRcontrib.initialize">
<span class="sig-name descname"><span class="pre">initialize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#craytraverse.crenderer.cRcontrib" title="craytraverse.crenderer.rcontrib_c.cRcontrib"><span class="pre">craytraverse.crenderer.rcontrib_c.cRcontrib</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">arglist</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">object</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="headerlink" href="#craytraverse.crenderer.cRcontrib.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>arglist (a sequence of strings) must be a member of calling
instance and persist for duration of program</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>arglist</strong> (<em>list</em>) – a sequence of arguments to initialize renderer. must be a member of calling
instance and persist for duration of program</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>nproc</strong> – number of processors renderer initialized with or -1 if initialization failed.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="craytraverse.crenderer.cRcontrib.load_scene">
<span class="sig-name descname"><span class="pre">load_scene</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#craytraverse.crenderer.cRcontrib" title="craytraverse.crenderer.rcontrib_c.cRcontrib"><span class="pre">craytraverse.crenderer.rcontrib_c.cRcontrib</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">octree</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#craytraverse.crenderer.cRcontrib.load_scene" title="Permalink to this definition">¶</a></dt>
<dd><p>load scene file to renderer</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>octee</strong> (<em>str</em>) – path to octree file.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="craytraverse.crenderer.cRcontrib.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#craytraverse.crenderer.cRcontrib" title="craytraverse.crenderer.rcontrib_c.cRcontrib"><span class="pre">craytraverse.crenderer.rcontrib_c.cRcontrib</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#craytraverse.crenderer.cRcontrib.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>reset renderer state, must be called before loading an new scene or changing rendering
parameters</p>
</dd></dl>

</dd></dl>

<span class="target" id="module-craytraverse.craytraverse"></span><p>raytraverse helper functions written in c++</p>
<dl class="py function">
<dt class="sig sig-object py" id="craytraverse.craytraverse.from_pdf">
<span class="sig-prename descclassname"><span class="pre">craytraverse.craytraverse.</span></span><span class="sig-name descname"><span class="pre">from_pdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pdf</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.float64</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lb</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ub</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span></span></span><a class="headerlink" href="#craytraverse.craytraverse.from_pdf" title="Permalink to this definition">¶</a></dt>
<dd><p>helper function for draw.from_pdf</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pdf</strong> (<em>np.array</em>) – array of doubles with weights to check against threshold</p></li>
<li><p><strong>threshold</strong> (<em>float</em>) – value used to determine the number of indices to return</p></li>
<li><p><strong>lb</strong> (<em>float</em><em>, </em><em>optional</em>) – values below threshold * lb will be excluded from candidates (lb must be in (0,1)</p></li>
<li><p><strong>ub</strong> (<em>float</em><em>, </em><em>optional</em>) – values above threshold * ub will have indices written to bidx</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>candidates</strong> (<em>np.array</em>) – array of candidate indices</p></li>
<li><p><strong>bidx</strong> (<em>np.array</em>) – array of definitely included indices</p></li>
<li><p><strong>nsampc</strong> (<em>int</em>) – the number of draws that should be selected from the candidates</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="craytraverse.craytraverse.interpolate_kdquery">
<span class="sig-prename descclassname"><span class="pre">craytraverse.craytraverse.</span></span><span class="sig-name descname"><span class="pre">interpolate_kdquery</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">destvec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.float64</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">errs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.float64</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idxs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.int32</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">srcvec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.float64</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">srclum</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.float64</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">err</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.00436</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.float64</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#craytraverse.craytraverse.interpolate_kdquery" title="Permalink to this definition">¶</a></dt>
<dd><p>interpolate luminance values associated with query results
from scipy.cKDTree.query. Finds closest point and then locates vertices of enclosing triangle from this point.
returns 0 in cases where the query provides no results, so the distance_upper_bound must be set appropriately.
:param dest_vec: destination vectors to interpolate to, shape (N, 3)
:type dest_vec: np.array
:param errs: distances between src and destination (row matches dest_vec, column is sorted ascending), shape (N, # of queries)
:type errs: np.array
:param idxs: query result, index row in src_vec close to dest_vec, shape (N, # of queries)
:type idxs: np.array
:param src_vec: vectors of src_kd, shape (N, 3)
:type src_vec: np.array
:param src_lum: luminance values for src_kd, shape (src_vec.shape[0], srcn)
:type src_lum: np.array
:param err: distance below which closest sample is used directly
:type err: float, optional</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>arrout</strong> – destination luminances shape (N, srcn)</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>np.array</p>
</dd>
</dl>
</dd></dl>

</section>